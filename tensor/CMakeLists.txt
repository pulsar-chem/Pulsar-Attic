################################################################################
###                    This file autogenerated using AddExt.py               ###
###                 For general modifications please edit AddExt.py          ###
################################################################################
include(ExternalProject)

find_package(tensor QUIET)

if(NOT TENSOR_FOUND)
   message(STATUS "We will build libtensor for you")
#Add the path to madness, assuming libtaskforce was built
list(APPEND CMAKE_PREFIX_PATH ${CMAKE_BINARY_DIR}/stage/${CMAKE_INSTALL_PREFIX}/external/libtaskforce/external/madness)

ExternalProject_Add(libtensor_external
   SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/tensor-source
   CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_INSTALL_PREFIX}/external/tensor
   -DPYTHON_LIBRARY=${PYTHON_LIBRARY}
   -DPYTHON_INCLUDE_DIR=${PYTHON_INCLUDE_DIR}
   -DPYTHON_EXECUTABLE=${PYTHON_EXECUTABLE}
   -DCMAKE_CXX_FLAGS=${CMAKE_CXX_FLAGS}
   -DMPI_CXX_COMPILER=${MPI_CXX_COMPILER}
   -DMPI_C_COMPILER=${MPI_C_COMPILER}
   -DMPI_Fortran_COMPILER=${MPI_Fortran_COMPILER}
   -DCMAKE_CXX_COMPILER=${CMAKE_CXX_COMPILER}
   -DCMAKE_C_COMPILER=${CMAKE_C_COMPILER}
   -DCMAKE_Fortran_COMPILER=${CMAKE_Fortran_COMPILER}
   CMAKE_CACHE_ARGS -DLAPACK_LIBRARIES:STRING=${PULSAR_MATH_LIBS}
                    -DCMAKE_PREFIX_PATH:STRING=${CMAKE_PREFIX_PATH}
   INSTALL_COMMAND ${CMAKE_MAKE_PROGRAM} install DESTDIR=${CMAKE_BINARY_DIR}/stage
)
   add_dependencies(libtensor_external libtaskforce_external)
else()
   add_library(libtensor_external INTERFACE)
endif()
